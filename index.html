<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red Intercultural Juvenil - RIJ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="assets/data.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500;600;700;800;900&display=swap');
        
        :root {
            --color-primary: #ff6b35;
            --color-secondary: #004e89;
            --color-accent: #f7b801;
            --color-verde: #2a9d8f;
            --color-morado: #6a4c93;
        }

        * {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Work Sans', sans-serif;
            overflow-x: hidden;
        }

        h1, h2, h3 {
            font-family: 'Work Sans', sans-serif;
            font-weight: 900;
        }

        /* Animaci√≥n sutil al cargar */
        .fade-in {
            animation: fadeIn 1s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Patr√≥n jaguar para el directorio */
        .jaguar-pattern {
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(0,0,0,0.15) 2%, transparent 3%),
                radial-gradient(circle at 60% 50%, rgba(0,0,0,0.1) 3%, transparent 4%),
                radial-gradient(circle at 35% 70%, rgba(0,0,0,0.12) 2.5%, transparent 3.5%),
                radial-gradient(circle at 80% 20%, rgba(0,0,0,0.08) 2%, transparent 3%),
                radial-gradient(circle at 15% 85%, rgba(0,0,0,0.1) 2.8%, transparent 3.8%);
            background-size: 100px 100px;
            background-color: #f7e7ce;
        }

        /* Secciones con altura completa */
        section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 3rem 1rem;
            position: relative;
        }

        @media (min-width: 768px) {
            section {
                padding: 4rem 2rem;
            }
        }

        /* Mapa interactivo */
        #map {
            height: 400px;
            width: 100%;
            border-radius: 0;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        @media (min-width: 768px) {
            #map {
                height: 500px;
            }
        }

        @media (min-width: 1024px) {
            #map {
                height: 600px;
            }
        }

        /* Card de organizaci√≥n en mapa */
        .org-popup {
            min-width: 240px;
            max-width: 280px;
            text-align: center;
        }

        .org-popup img {
            max-width: 80px;
            max-height: 80px;
            object-fit: contain;
            display: block;
            margin: 0 auto 10px;
            background: white;
            padding: 8px;
            border-radius: 8px;
        }

        @media (min-width: 640px) {
            .org-popup {
                min-width: 280px;
            }
            .org-popup img {
                max-width: 100px;
                max-height: 100px;
            }
        }

        /* Franja amarilla de aforismos - flash style */
        .aforismos-banner {
            background-color: var(--color-accent);
            position: fixed;
            left: 0;
            width: 100%;
            z-index: 999;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            text-align: right;
            padding: 0.6rem 1.5rem;
            min-height: 3.2rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-end;
        }

        .aforismo-flash {
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
            text-align: right;
        }

        .aforismo-flash.visible {
            opacity: 1;
        }

        .aforismo-frase {
            font-family: 'Work Sans', sans-serif;
            font-weight: 800;
            font-size: 1.2rem;
            color: #1a1a1a;
            line-height: 1.3;
            letter-spacing: -0.01em;
        }

        .aforismo-org {
            font-family: 'Work Sans', sans-serif;
            font-weight: 400;
            font-size: 0.75rem;
            font-style: italic;
            color: #555;
            margin-top: 0.15rem;
        }

        .aforismo-org::before {
            content: '‚Äî ';
        }

        @media (max-width: 639px) {
            .aforismo-frase {
                font-size: 0.95rem;
            }
            .aforismo-org {
                font-size: 0.65rem;
            }
            .aforismos-banner {
                padding: 0.5rem 1rem;
            }
        }

        /* Manifiesto word-by-word scroll */
        #manifiesto {
            display: block;
            padding: 0;
        }

        .manifiesto-sticky {
            position: sticky;
            top: 0;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .manifiesto-titulo {
            font-weight: 900;
            font-size: clamp(3rem, 8vw, 6rem);
            text-transform: uppercase;
            letter-spacing: -0.03em;
            line-height: 1.15;
            text-align: center;
            margin-bottom: 1.5rem;
            color: white;
        }

        .manifiesto-titulo .mw {
            opacity: 0;
            transition: opacity 0.25s ease;
        }

        .manifiesto-titulo .mw.vis {
            opacity: 1;
        }

        .manifiesto-cuerpo {
            font-weight: 400;
            font-size: clamp(1.15rem, 2.5vw, 2.5rem);
            line-height: 1.65;
            text-align: left;
            color: rgba(255, 255, 255, 0.92);
        }

        .manifiesto-cuerpo .mw {
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .manifiesto-cuerpo .mw.vis {
            opacity: 1;
        }

        /* Tarjetas de directorio */
        .org-card {
            background: white;
            border-radius: 15px;
            padding: 1rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        @media (min-width: 640px) {
            .org-card {
                padding: 1.5rem;
                border-radius: 20px;
            }
        }

        .org-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .org-logo {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin: 0 auto 0.75rem;
            display: block;
            background: white;
            padding: 8px;
            border-radius: 8px;
        }

        @media (min-width: 640px) {
            .org-logo {
                width: 100px;
                height: 100px;
                padding: 10px;
                margin: 0 auto 1rem;
            }
        }

        @media (min-width: 1024px) {
            .org-logo {
                width: 120px;
                height: 120px;
            }
        }

        /* Navegaci√≥n flotante */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        /* Asegurar que el bot√≥n hamburguesa no se salga */
        nav .nav-inner {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            min-width: 0;
        }

        #menu-toggle {
            flex-shrink: 0;
            padding: 0.5rem;
            margin-left: 0.5rem;
            z-index: 1001;
        }

        nav a {
            transition: color 0.3s ease;
        }

        nav a:hover {
            color: var(--color-primary);
        }

        /* Logo RIJ en nav */
        nav .text-3xl {
            line-height: 1;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        /* Fondo de fotos aleatorias en inicio */
        #inicio {
            position: relative;
            overflow: hidden;
            background-color: #333;
            cursor: pointer;
        }

        /* Estilos para √°lbumes de galer√≠a */
        .album-card {
            position: relative;
            overflow: hidden;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            aspect-ratio: 16 / 9;
        }

        @media (max-width: 639px) {
            .album-card {
                aspect-ratio: 4 / 3;
            }
        }

        .album-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .album-card .album-bg {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover;
            background-position: center;
            transition: opacity 2s ease-in-out;
        }

        .album-card .album-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to top, rgba(0,0,0,0.85) 0%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.1) 100%);
            z-index: 1;
        }

        .album-card .album-info {
            position: absolute;
            bottom: 0; left: 0; right: 0;
            padding: 1.5rem;
            z-index: 2;
            color: white;
        }

        .album-card .album-info h3 {
            font-size: 1.25rem;
            font-weight: 800;
            margin-bottom: 0.25rem;
        }

        @media (min-width: 1024px) {
            .album-card .album-info h3 {
                font-size: 1.75rem;
            }
            .album-card .album-info p {
                font-size: 1rem;
            }
        }

        .album-card .album-info p {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        .album-card .album-count {
            position: absolute;
            top: 1rem; right: 1rem;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            padding: 0.3rem 0.8rem;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 700;
            color: white;
            z-index: 2;
        }

        @media (min-width: 1024px) {
            .album-card .album-count {
                font-size: 0.9rem;
                padding: 0.4rem 1rem;
            }
        }

        /* Modal lightbox */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-image-container {
            position: relative;
            width: 90vw;
            height: 75vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-image-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 8px;
            transition: opacity 0.8s ease-in-out;
        }

        .modal-close {
            position: absolute;
            top: 1.5rem; right: 1.5rem;
            color: white;
            font-size: 2.5rem;
            cursor: pointer;
            z-index: 10000;
            background: rgba(255,255,255,0.1);
            width: 50px; height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
            border: none;
        }

        .modal-close:hover {
            background: rgba(255,255,255,0.3);
        }

        .modal-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 3rem;
            cursor: pointer;
            background: rgba(255,255,255,0.1);
            width: 60px; height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
            border: none;
            z-index: 10000;
        }

        .modal-nav:hover {
            background: rgba(255,255,255,0.3);
        }

        .modal-nav.prev { left: 1.5rem; }
        .modal-nav.next { right: 1.5rem; }

        .modal-info {
            color: white;
            text-align: center;
            margin-top: 1rem;
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .modal-album-title {
            color: white;
            text-align: center;
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }

        @media (max-width: 639px) {
            .modal-nav { width: 45px; height: 45px; font-size: 2rem; }
            .modal-nav.prev { left: 0.5rem; }
            .modal-nav.next { right: 0.5rem; }
            .modal-close { top: 0.5rem; right: 0.5rem; width: 40px; height: 40px; font-size: 1.8rem; }
        }

        /* Responsive helpers */
        @media (max-width: 639px) {
            h1 {
                font-size: 2.5rem !important;
                line-height: 1.2;
            }
            h2 {
                font-size: 1.75rem !important;
            }
            .text-6xl {
                font-size: 2.5rem !important;
            }
            .text-8xl {
                font-size: 3rem !important;
            }
            /* Asegurar hamburguesa visible en pantallas estrechas */
            nav .max-w-7xl {
                padding-left: 0.75rem;
                padding-right: 0.75rem;
            }
        }

        /* Mejorar legibilidad en m√≥viles */
        @media (max-width: 767px) {
            body {
                font-size: 0.9rem;
            }
        }

        /* Orientaci√≥n horizontal en m√≥viles */
        @media (max-width: 896px) and (max-height: 414px) and (orientation: landscape) {
            section {
                min-height: auto;
                padding: 2rem 1rem;
            }
        }
    </style>
</head>
<body class="bg-white text-gray-900">

    <!-- Navegaci√≥n Fija (compacta) -->
    <nav class="py-1" id="main-nav">
        <div class="max-w-7xl mx-auto px-4">
            <div class="nav-inner">
                <div class="flex items-center flex-shrink-0">
                    <img src="assets/logos/RIJ_SIGLA.png" alt="Red Intercultural Juvenil" class="h-12 md:h-16">
                </div>
                <ul class="hidden md:flex space-x-5 text-xs font-medium">
                    <li><a href="#inicio" class="hover:text-orange-500">Inicio</a></li>
                    <li><a href="#galeria" class="hover:text-orange-500">Galer√≠a</a></li>
                    <li><a href="#manifiesto" class="hover:text-orange-500">Manifiesto</a></li>
                    <li><a href="#mapa" class="hover:text-orange-500">Mapa</a></li>
                    <li><a href="#directorio" class="hover:text-orange-500">Directorio</a></li>
                    <li><a href="#articulaciones" class="hover:text-orange-500">Articulaciones</a></li>
                    <li><a href="#salvaguarda" class="hover:text-orange-500">Salvaguarda</a></li>
                    <li><a href="#envolvente" class="hover:text-orange-500">Envolvente</a></li>
                    <li><a href="#contacto" class="hover:text-orange-500">Contacto</a></li>
                </ul>
                <button id="menu-toggle" class="md:hidden">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
    </nav>

    <!-- Franja amarilla de aforismos (debajo del nav) -->
    <div class="aforismos-banner" id="aforismos-banner">
        <div class="aforismo-flash" id="aforismo-flash">
            <div class="aforismo-frase" id="aforismo-frase"></div>
            <div class="aforismo-org" id="aforismo-org"></div>
        </div>
    </div>

    <!-- SECCI√ìN 1: INTRO/PORTADA CON SLIDESHOW -->
    <section id="inicio" class="h-screen flex items-center justify-center text-white relative overflow-hidden" style="background-color: #333;">
        <!-- Capas de fondo para slideshow con crossfade -->
        <div id="bg-layer-1" style="position:absolute;top:0;left:0;width:100%;height:100%;background-size:cover;background-position:center;background-repeat:no-repeat;z-index:0;opacity:1;transition:opacity 3s ease-in-out;"></div>
        <div id="bg-layer-2" style="position:absolute;top:0;left:0;width:100%;height:100%;background-size:cover;background-position:center;background-repeat:no-repeat;z-index:1;opacity:0;transition:opacity 3s ease-in-out;"></div>
        
        <!-- Contenido sobre el slideshow -->
        <div class="max-w-7xl mx-auto text-center fade-in" style="position:relative;z-index:10;">
            <div class="mb-2" style="margin-top: -80px;">
                <img src="assets/logos/RIJ_COMP_NEG.png" alt="Red Intercultural Juvenil" class="w-full drop-shadow-2xl">
            </div>
            <p class="text-2xl md:text-3xl font-light max-w-4xl mx-auto mb-12 px-4" style="margin-top: -60px; font-style: italic; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                Tejiendo identidades, fortaleciendo territorios
            </p>
            <div class="flex justify-center gap-6 flex-wrap px-4">
                <div class="bg-white/20 backdrop-blur px-8 py-4 rounded-full font-black text-lg md:text-xl" style="font-family: 'Work Sans', sans-serif;">27 Organizaciones</div>
                <div class="bg-white/20 backdrop-blur px-8 py-4 rounded-full font-black text-lg md:text-xl" style="font-family: 'Work Sans', sans-serif;">15 Departamentos</div>
                <div class="bg-white/20 backdrop-blur px-8 py-4 rounded-full font-black text-lg md:text-xl" style="font-family: 'Work Sans', sans-serif;">Una Red</div>
            </div>
        </div>
    </section>

    <!-- SECCI√ìN 3: GALER√çA -->
    <section id="galeria" class="bg-gray-50">
        <div class="max-w-7xl mx-auto w-full">
            <h2 class="text-4xl md:text-5xl font-bold text-center mb-12 text-gray-900">Galer√≠a Visual</h2>
            <p class="text-center text-gray-500 mb-8 -mt-8">Haz clic en un √°lbum para ver las fotos</p>
            <div id="gallery-grid">
                <!-- Los √°lbumes se cargar√°n din√°micamente aqu√≠ -->
            </div>
        </div>
    </section>

    <!-- Modal Lightbox para √°lbumes -->
    <div class="modal-overlay" id="album-modal">
        <button class="modal-close" onclick="closeAlbumModal()">&times;</button>
        <button class="modal-nav prev" onclick="prevPhoto()">&#8249;</button>
        <button class="modal-nav next" onclick="nextPhoto()">&#8250;</button>
        <div class="modal-album-title" id="modal-album-title"></div>
        <div class="modal-image-container">
            <img id="modal-image" src="" alt="">
        </div>
        <div class="modal-info" id="modal-info"></div>
    </div>

    <!-- SECCI√ìN 4: MANIFIESTO - WORD BY WORD SCROLL -->
    <section id="manifiesto" class="relative bg-zinc-900 text-white">
        <div class="manifiesto-sticky">
            <div class="absolute inset-0 opacity-20" style="background-image: url('https://www.transparenttextures.com/patterns/asphalt-dark.png');"></div>
            <div class="absolute top-0 right-0 w-96 h-96 bg-pink-600 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse"></div>
            <div class="absolute bottom-0 left-0 w-96 h-96 bg-cyan-600 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse" style="animation-delay: 1s;"></div>

            <div class="max-w-5xl mx-auto px-6 relative z-10">
                <div class="manifiesto-titulo" id="manifiesto-titulo"></div>
                <div class="manifiesto-cuerpo" id="manifiesto-cuerpo"></div>
            </div>
        </div>
    </section>

    <!-- SECCI√ìN 5: MAPA DE TERRITORIALIZACI√ìN -->
    <section id="mapa" class="bg-blue-50">
        <div class="w-full">
            <div class="max-w-7xl mx-auto px-4 mb-8">
                <h2 class="text-4xl md:text-5xl font-bold text-center mb-6 text-gray-900">Mapa de Nodos</h2>
                <p class="text-center text-gray-600 max-w-2xl mx-auto">
                    Visualiza la presencia territorial de las organizaciones que conforman la Red Intercultural Juvenil
                </p>
            </div>
            <div id="map"></div>
        </div>
    </section>

    <!-- SECCI√ìN 6: DIRECTORIO DE ORGANIZACIONES -->
    <section id="directorio" class="jaguar-pattern">
        <div class="max-w-7xl mx-auto">
            <h2 class="text-4xl md:text-5xl font-bold text-center mb-12 text-gray-900">Directorio Vivo de Organizaciones</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="directorio-grid">
                <!-- Las fichas se cargar√°n din√°micamente aqu√≠ -->
            </div>
        </div>
    </section>

    <!-- SECCI√ìN 7: ARTICULACIONES -->
    <section id="articulaciones" class="bg-gradient-to-r from-amber-400 to-orange-500 text-white">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-4xl md:text-5xl font-bold text-center mb-12">Articulaciones y Logros</h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white/10 backdrop-blur rounded-xl p-6">
                    <h3 class="text-2xl font-bold mb-4">Redam √ó Yucuta</h3>
                    <p>Colaboraci√≥n en proyectos de preservaci√≥n cultural amaz√≥nica</p>
                </div>
                <div class="bg-white/10 backdrop-blur rounded-xl p-6">
                    <h3 class="text-2xl font-bold mb-4">Kombilesa Mi √ó ODEC</h3>
                    <p>Alianza para el fortalecimiento de identidades juveniles</p>
                </div>
                <div class="bg-white/10 backdrop-blur rounded-xl p-6">
                    <h3 class="text-2xl font-bold mb-4">Bari Rock √ó La Tigra</h3>
                    <p>Fusi√≥n musical y cultural en territorios de frontera</p>
                </div>
                <div class="bg-white/10 backdrop-blur rounded-xl p-6">
                    <h3 class="text-2xl font-bold mb-4">Biohoty √ó Enraizarte</h3>
                    <p>Intercambio de saberes ambientales y art√≠sticos</p>
                </div>
            </div>
        </div>
    </section>

    <!-- SECCI√ìN 8: SALVAGUARDA -->
    <section id="salvaguarda" class="bg-gradient-to-br from-green-700 to-teal-800 text-white">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-4xl md:text-5xl font-bold text-center mb-12">Cuando el Territorio Habla</h2>
            <div class="bg-white/10 backdrop-blur rounded-2xl p-8 md:p-12">
                <p class="text-lg leading-relaxed mb-6">
                    La salvaguarda no es solo un protocolo administrativo, es el compromiso de escuchar 
                    las voces ancestrales que habitan los territorios donde trabajamos.
                </p>
                <p class="text-lg leading-relaxed mb-6">
                    Reconocemos que cada organizaci√≥n es guardiana de saberes, tradiciones y cosmovisiones 
                    que merecen ser preservadas, transmitidas y celebradas.
                </p>
                <div class="border-l-4 border-white pl-6 italic">
                    <p class="text-xl">"El territorio no es un lugar, es una memoria viva que late en cada uno de nosotros"</p>
                </div>
            </div>
        </div>
    </section>

    <!-- SECCI√ìN 9: ENVOLVENTE -->
    <section id="envolvente" class="bg-gradient-to-r from-indigo-600 to-purple-700 text-white">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-4xl md:text-5xl font-bold text-center mb-12">Envolvente</h2>
            <div class="bg-white/10 backdrop-blur rounded-2xl p-8 md:p-12">
                <h3 class="text-2xl font-bold mb-6">Proceso de Integraci√≥n a la Red</h3>
                <div class="space-y-6">
                    <div class="flex items-start gap-4">
                        <div class="bg-white text-indigo-600 rounded-full w-10 h-10 flex items-center justify-center font-bold flex-shrink-0">1</div>
                        <div>
                            <h4 class="font-bold text-lg mb-2">Manifestaci√≥n de Inter√©s</h4>
                            <p>Las organizaciones expresan su deseo de formar parte de la red</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-4">
                        <div class="bg-white text-indigo-600 rounded-full w-10 h-10 flex items-center justify-center font-bold flex-shrink-0">2</div>
                        <div>
                            <h4 class="font-bold text-lg mb-2">Caracterizaci√≥n</h4>
                            <p>Proceso de conocimiento mutuo y reconocimiento territorial</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-4">
                        <div class="bg-white text-indigo-600 rounded-full w-10 h-10 flex items-center justify-center font-bold flex-shrink-0">3</div>
                        <div>
                            <h4 class="font-bold text-lg mb-2">Formalizaci√≥n</h4>
                            <p>Acuerdos de colaboraci√≥n y participaci√≥n activa en la red</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECCI√ìN 10: CONTACTO -->
    <section id="contacto" class="bg-gray-900 text-white">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-4xl md:text-5xl font-bold mb-12">Contacto</h2>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white/5 backdrop-blur rounded-xl p-8">
                    <h3 class="text-xl font-bold mb-4">Email</h3>
                    <a href="mailto:info@redinterculturaljuvenil.org" class="text-orange-400 hover:text-orange-300">
                        info@redinterculturaljuvenil.org
                    </a>
                </div>
                <div class="bg-white/5 backdrop-blur rounded-xl p-8">
                    <h3 class="text-xl font-bold mb-4">Redes Sociales</h3>
                    <div class="flex justify-center gap-4 text-3xl">
                        <a href="#" class="hover:text-orange-400">üì∑</a>
                        <a href="#" class="hover:text-orange-400">üìò</a>
                        <a href="#" class="hover:text-orange-400">üê¶</a>
                    </div>
                </div>
            </div>
            <p class="mt-12 text-gray-400 text-sm">
                ¬© 2026 Red Intercultural Juvenil - Todos los derechos reservados
            </p>
        </div>
    </section>

    <script>
        // Array de fotos de organizaciones (92 fotos totales)
        const fotosOrgs = [
            'assets/photos_orgs/01_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/01_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/01_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/01_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/01_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/02_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/02_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/02_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/02_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/02_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/03_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/03_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/03_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/03_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/03_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/04_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/04_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/04_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/04_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/04_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/05_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/05_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/05_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/05_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/05_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/06_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/06_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/06_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/06_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/06_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/07_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/07_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/07_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/07_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/07_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/08_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/08_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/08_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/08_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/08_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/09_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/09_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/09_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/09_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/09_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/10_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/10_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/10_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/10_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/10_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/11_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/11_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/11_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/11_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/11_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/12_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/12_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/12_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/12_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/12_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/13_CODIGO_ESTILO_CREW_2025.jpg',
            'assets/photos_orgs/13_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/13_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/13_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/13_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/14_CUMBRE_CASA_CULTURAL.jpg',
            'assets/photos_orgs/14_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/14_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/14_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/15_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/15_MALOKA_JOVEN_2025.jpg',
            'assets/photos_orgs/15_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/15_THE_GIANT_CORPORATION_2025.jpg',
            'assets/photos_orgs/16_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/16_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/17_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/17_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/18_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/18_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/19_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/19_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/20_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/20_RED_CEPELA_2025.jpg',
            'assets/photos_orgs/21_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/22_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/23_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/24_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/25_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/26_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/27_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/28_GUAQUE_SOPO_2025.jpg',
            'assets/photos_orgs/29_GUAQUE_SOPO_2025.jpg'
        ];

        // Sistema de shuffle sin repeticiones
        let shuffledPhotos = [];
        let currentShuffleIndex = 0;

        // Crear nuevo shuffle
        function createShuffle() {
            shuffledPhotos = [...fotosOrgs];
            // Algoritmo Fisher-Yates para mezclar
            for (let i = shuffledPhotos.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledPhotos[i], shuffledPhotos[j]] = [shuffledPhotos[j], shuffledPhotos[i]];
            }
            currentShuffleIndex = 0;
        }

        // Obtener siguiente foto del shuffle
        function getNextPhoto() {
            if (currentShuffleIndex >= shuffledPhotos.length) {
                createShuffle();
            }
            const photo = shuffledPhotos[currentShuffleIndex];
            currentShuffleIndex++;
            return photo;
        }

        // Mapeo de nombres de fotos a organizaciones
        function getOrgFromPhoto(photoPath) {
            const filename = photoPath.split('/').pop().toUpperCase();
            
            if (filename.includes('CODIGO_ESTILO_CREW')) {
                return organizaciones.find(org => 
                    org.nombre && org.nombre.toLowerCase().includes('c√≥digo estilo')
                );
            } else if (filename.includes('THE_GIANT_CORPORATION')) {
                return organizaciones.find(org => 
                    org.nombre && org.nombre.toLowerCase().includes('giant')
                );
            } else if (filename.includes('RED_CEPELA')) {
                return organizaciones.find(org => 
                    org.nombre && org.nombre.toLowerCase().includes('cepela')
                );
            } else if (filename.includes('CASA_CULTURAL')) {
                return organizaciones.find(org => 
                    org.nombre && org.nombre.toLowerCase().includes('casa cultural')
                );
            } else if (filename.includes('MALOKA')) {
                return organizaciones.find(org => 
                    org.nombre && org.nombre.toLowerCase().includes('maloka')
                );
            } else if (filename.includes('GUAQUE') || filename.includes('SOPO')) {
                return organizaciones.find(org => 
                    org.nombre && (org.nombre.toLowerCase().includes('guaque') || org.municipio.toLowerCase().includes('sop√≥'))
                );
            }
            
            return null;
        }

        // Precarga de todas las im√°genes con promesas
        let imagesPreloaded = false;
        const preloadedImages = [];
        
        function preloadImages() {
            return new Promise((resolve) => {
                let loaded = 0;
                const total = fotosOrgs.length;
                fotosOrgs.forEach((src) => {
                    const img = new Image();
                    img.onload = () => {
                        loaded++;
                        if (loaded >= total) {
                            imagesPreloaded = true;
                            resolve();
                        }
                    };
                    img.onerror = () => {
                        loaded++;
                        if (loaded >= total) {
                            imagesPreloaded = true;
                            resolve();
                        }
                    };
                    img.src = src;
                    preloadedImages.push(img);
                });
            });
        }

        // Funci√≥n para seleccionar foto con sistema de shuffle
        let currentPhotoPath = null;
        let activeLayer = 1; // 1 o 2 - cu√°l capa est√° visible ahora
        
        function setRandomBackground(fade) {
            const layer1 = document.getElementById('bg-layer-1');
            const layer2 = document.getElementById('bg-layer-2');
            if (!layer1 || !layer2) return;
            
            const randomPhoto = getNextPhoto();
            currentPhotoPath = randomPhoto;
            
            if (!fade) {
                // Primera carga: mostrar directamente en layer1
                layer1.style.backgroundImage = "url('" + randomPhoto + "')";
                layer1.style.opacity = '1';
                layer1.style.zIndex = '0';
                layer2.style.opacity = '0';
                layer2.style.zIndex = '1';
                activeLayer = 1;
                return;
            }
            
            // Crossfade: la nueva foto se carga en la capa inactiva (encima, invisible)
            // y luego hace fade in, tapando la anterior
            if (activeLayer === 1) {
                // layer1 est√° visible, cargar nueva foto en layer2 (encima)
                layer2.style.transition = 'none'; // quitar transici√≥n para poner invisible
                layer2.style.opacity = '0';
                layer2.style.zIndex = '1'; // encima
                layer1.style.zIndex = '0'; // debajo
                layer2.style.backgroundImage = "url('" + randomPhoto + "')";
                
                // Forzar reflow para que el cambio de opacity sin transici√≥n tome efecto
                layer2.offsetHeight;
                
                // Ahora s√≠ restaurar transici√≥n y hacer fade in
                layer2.style.transition = 'opacity 3s ease-in-out';
                
                // Peque√±o delay y luego fade in
                requestAnimationFrame(() => {
                    requestAnimationFrame(() => {
                        layer2.style.opacity = '1';
                    });
                });
                
                activeLayer = 2;
            } else {
                // layer2 est√° visible, cargar nueva foto en layer1 (encima)
                layer1.style.transition = 'none'; // quitar transici√≥n para poner invisible
                layer1.style.opacity = '0';
                layer1.style.zIndex = '1'; // encima
                layer2.style.zIndex = '0'; // debajo
                layer1.style.backgroundImage = "url('" + randomPhoto + "')";
                
                // Forzar reflow
                layer1.offsetHeight;
                
                // Restaurar transici√≥n y hacer fade in
                layer1.style.transition = 'opacity 3s ease-in-out';
                
                requestAnimationFrame(() => {
                    requestAnimationFrame(() => {
                        layer1.style.opacity = '1';
                    });
                });
                
                activeLayer = 1;
            }
        }

        // Cambiar foto cada 5 segundos
        function startPhotoRotation() {
            setInterval(() => {
                setRandomBackground(true);
            }, 5000);
        }

        // Inicializar mapa
        function initMap() {
            const map = L.map('map').setView([4.5709, -74.2973], 6); // Colombia centrada
            window.mapInstance = map; // Guardar referencia global
            
            // Usar un tile layer colorido y gratuito
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors',
                maxZoom: 18
            }).addTo(map);

            // Agregar marcadores de organizaciones
            organizaciones.forEach(org => {
                if (org.lat && org.lng) {
                    const marker = L.marker([org.lat, org.lng]).addTo(map);
                    
                    const socialLinks = [];
                    if (org.instagram) socialLinks.push(`<a href="${org.instagram}" target="_blank" class="hover:scale-110 transition">üì∑</a>`);
                    if (org.facebook) socialLinks.push(`<a href="${org.facebook}" target="_blank" class="hover:scale-110 transition">üìò</a>`);
                    if (org.tiktok) socialLinks.push(`<a href="${org.tiktok}" target="_blank" class="hover:scale-110 transition">üéµ</a>`);
                    if (org.youtube) socialLinks.push(`<a href="${org.youtube}" target="_blank" class="hover:scale-110 transition">üì∫</a>`);
                    if (org.twitter) socialLinks.push(`<a href="${org.twitter}" target="_blank" class="hover:scale-110 transition">üê¶</a>`);
                    
                    marker.bindPopup(`
                        <div class="org-popup">
                            ${org.logo ? `<img src="${org.logo}" alt="${org.nombre}" onerror="this.style.display='none'">` : ''}
                            <h3 class="font-bold text-lg mt-2">${org.nombre}</h3>
                            <p class="text-sm text-gray-600">${org.municipio}</p>
                            <p class="text-sm mt-2"><strong>Contacto:</strong> ${org.representante}</p>
                            <p class="text-sm">${org.email}</p>
                            <p class="text-sm">${org.telefono}</p>
                            ${socialLinks.length > 0 ? `<div class="flex gap-2 mt-2 text-xl">${socialLinks.join('')}</div>` : ''}
                        </div>
                    `);
                }
            });
        }

        // Agrupar fotos por organizaci√≥n
        function getAlbums() {
            const albums = {};
            const albumNames = {
                'CODIGO_ESTILO_CREW_2025': 'C√≥digo Estilo Crew 2025',
                'CUMBRE_CASA_CULTURAL': 'Cumbre Casa Cultural',
                'MALOKA_JOVEN_2025': 'Maloka Joven 2025',
                'GUAQUE_SOPO_2025': 'Guaque Sop√≥ 2025',
                'RED_CEPELA_2025': 'Red Cepela 2025',
                'THE_GIANT_CORPORATION_2025': 'The Giant Corporation 2025'
            };
            
            fotosOrgs.forEach(foto => {
                const filename = foto.split('/').pop();
                // Extraer nombre de org quitando el n√∫mero inicial
                const match = filename.match(/^\d+_(.+)\.jpg$/i);
                if (match) {
                    const key = match[1];
                    if (!albums[key]) {
                        albums[key] = {
                            name: albumNames[key] || key.replace(/_/g, ' '),
                            photos: []
                        };
                    }
                    albums[key].photos.push(foto);
                }
            });
            return albums;
        }

        // Variables del modal
        let currentAlbumPhotos = [];
        let currentPhotoIndex = 0;
        let modalAutoplay = null;

        // Cargar galer√≠a como √°lbumes - grid responsivo seg√∫n cantidad
        function loadGallery() {
            const grid = document.getElementById('gallery-grid');
            const albums = getAlbums();
            const albumKeys = Object.keys(albums);
            const count = albumKeys.length;
            
            // Determinar columnas seg√∫n cantidad de √°lbumes
            let gridClass = '';
            if (count <= 2) {
                gridClass = 'grid grid-cols-1 lg:grid-cols-' + count + ' gap-6';
            } else if (count <= 4) {
                gridClass = 'grid grid-cols-1 sm:grid-cols-2 gap-6';
            } else if (count <= 9) {
                gridClass = 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6';
            } else {
                gridClass = 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6';
            }
            
            grid.className = gridClass;
            
            grid.innerHTML = albumKeys.map((key, idx) => {
                const album = albums[key];
                const coverPhoto = album.photos[0];
                return `
                    <div class="album-card" onclick="openAlbum('${key}')" id="album-${idx}">
                        <div class="album-bg" style="background-image: url('${coverPhoto}'); opacity: 1;" data-album-key="${key}"></div>
                        <div class="album-overlay"></div>
                        <div class="album-count">üì∑ ${album.photos.length} fotos</div>
                        <div class="album-info">
                            <h3>${album.name}</h3>
                            <p>Clic para ver el √°lbum</p>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Iniciar slideshows en portadas de √°lbumes
            startAlbumCoverSlideshows(albums);
        }

        // Slideshow en portadas de cada √°lbum (solo se activa en hover/rollover con crossfade)
        function startAlbumCoverSlideshows(albums) {
            Object.keys(albums).forEach(key => {
                const album = albums[key];
                if (album.photos.length <= 1) return;
                
                let idx = 0;
                const bgEl = document.querySelector(`[data-album-key="${key}"]`);
                if (!bgEl) return;
                const card = bgEl.parentElement;
                
                // Crear segunda capa para crossfade
                const bg2 = document.createElement('div');
                bg2.className = 'album-bg';
                bg2.style.opacity = '0';
                card.insertBefore(bg2, bgEl.nextSibling);
                
                let activeBg = bgEl;
                let inactiveBg = bg2;
                let hoverInterval = null;
                
                // Funci√≥n de crossfade
                function doCrossfade() {
                    idx = (idx + 1) % album.photos.length;
                    inactiveBg.style.backgroundImage = `url('${album.photos[idx]}')`;
                    inactiveBg.style.transition = 'none';
                    inactiveBg.style.opacity = '0';
                    inactiveBg.offsetHeight; // reflow
                    inactiveBg.style.transition = 'opacity 2s ease-in-out';
                    
                    requestAnimationFrame(() => {
                        requestAnimationFrame(() => {
                            inactiveBg.style.opacity = '1';
                            activeBg.style.opacity = '0';
                        });
                    });
                    
                    // Intercambiar capas
                    [activeBg, inactiveBg] = [inactiveBg, activeBg];
                }
                
                // Solo iniciar rotaci√≥n al hacer hover (rollover)
                card.addEventListener('mouseenter', () => {
                    // Hacer primer crossfade inmediato al entrar
                    doCrossfade();
                    // Continuar rotando cada 3 segundos mientras se mantiene el hover
                    hoverInterval = setInterval(doCrossfade, 3000);
                });
                
                card.addEventListener('mouseleave', () => {
                    // Detener rotaci√≥n al salir
                    if (hoverInterval) {
                        clearInterval(hoverInterval);
                        hoverInterval = null;
                    }
                });
            });
        }

        // Abrir √°lbum en modal
        function openAlbum(albumKey) {
            const albums = getAlbums();
            const album = albums[albumKey];
            if (!album) return;
            
            currentAlbumPhotos = album.photos;
            currentPhotoIndex = 0;
            
            document.getElementById('modal-album-title').textContent = album.name;
            updateModalImage();
            document.getElementById('album-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Autoplay cada 5 segundos
            modalAutoplay = setInterval(() => {
                currentPhotoIndex = (currentPhotoIndex + 1) % currentAlbumPhotos.length;
                updateModalImage();
            }, 5000);
        }

        // Actualizar imagen en modal
        function updateModalImage() {
            const img = document.getElementById('modal-image');
            img.style.opacity = '0';
            setTimeout(() => {
                img.src = currentAlbumPhotos[currentPhotoIndex];
                img.onload = () => { img.style.opacity = '1'; };
            }, 300);
            document.getElementById('modal-info').textContent = 
                `${currentPhotoIndex + 1} / ${currentAlbumPhotos.length}`;
        }

        // Navegaci√≥n del modal
        function nextPhoto() {
            currentPhotoIndex = (currentPhotoIndex + 1) % currentAlbumPhotos.length;
            updateModalImage();
            resetAutoplay();
        }

        function prevPhoto() {
            currentPhotoIndex = (currentPhotoIndex - 1 + currentAlbumPhotos.length) % currentAlbumPhotos.length;
            updateModalImage();
            resetAutoplay();
        }

        function resetAutoplay() {
            if (modalAutoplay) clearInterval(modalAutoplay);
            modalAutoplay = setInterval(() => {
                currentPhotoIndex = (currentPhotoIndex + 1) % currentAlbumPhotos.length;
                updateModalImage();
            }, 5000);
        }

        // Cerrar modal
        function closeAlbumModal() {
            document.getElementById('album-modal').classList.remove('active');
            document.body.style.overflow = '';
            if (modalAutoplay) clearInterval(modalAutoplay);
            modalAutoplay = null;
        }

        // Cerrar modal con Escape o clic fuera
        document.addEventListener('keydown', (e) => {
            if (!document.getElementById('album-modal').classList.contains('active')) return;
            if (e.key === 'Escape') closeAlbumModal();
            if (e.key === 'ArrowRight') nextPhoto();
            if (e.key === 'ArrowLeft') prevPhoto();
        });

        // Extraer nombre de organizaci√≥n de la foto
        function getOrgNameFromPhoto(photoPath) {
            const filename = photoPath.split('/').pop();
            if (filename.includes('CODIGO_ESTILO_CREW')) {
                return 'C√≥digo Estilo Crew 2025';
            } else if (filename.includes('THE_GIANT_CORPORATION')) {
                return 'The Giant Corporation 2025';
            } else if (filename.includes('RED_CEPELA')) {
                return 'Red Cepela 2025';
            } else if (filename.includes('CUMBRE_CASA_CULTURAL')) {
                return 'Cumbre Casa Cultural';
            } else if (filename.includes('MALOKA_JOVEN')) {
                return 'Maloka Joven 2025';
            } else if (filename.includes('GUAQUE_SOPO')) {
                return 'Guaque Sop√≥ 2025';
            }
            return 'Red Intercultural Juvenil';
        }

        // Navegar al mapa desde galer√≠a o slideshow
        function goToMapFromGallery(photoPath) {
            const org = getOrgFromPhoto(photoPath);
            
            // Navegar a la secci√≥n del mapa
            window.location.hash = '#mapa';
            
            // Scroll suave al mapa
            setTimeout(() => {
                document.getElementById('mapa').scrollIntoView({ behavior: 'smooth' });
                
                // Si encontramos la organizaci√≥n, abrir su popup en el mapa
                if (org && org.lat && org.lng) {
                    setTimeout(() => {
                        // Buscar el marcador correspondiente y hacer zoom
                        if (window.mapInstance) {
                            window.mapInstance.setView([org.lat, org.lng], 12);
                        }
                    }, 500);
                }
            }, 100);
        }

        // Hacer slideshow clicable
        function makeSlideShowClickable() {
            const inicioSection = document.getElementById('inicio');
            inicioSection.style.cursor = 'pointer';
            
            inicioSection.addEventListener('click', (e) => {
                // Solo si se hace clic en el fondo, no en el contenido
                if (e.target === inicioSection || e.target.tagName === 'SECTION') {
                    if (currentPhotoPath) {
                        goToMapFromGallery(currentPhotoPath);
                    }
                }
            });
        }
        function loadAforismos() {
            const track = document.getElementById('marquee-track');
            // Already removed marquee - use flash system instead
            shuffleAforismos();
            // Show first one immediately
            const item = aforismosShuffled[aforismoIndex];
            aforismoIndex++;
            document.getElementById('aforismo-frase').textContent = '\u201c' + item.frase + '\u201d';
            document.getElementById('aforismo-org').textContent = item.org;
            document.getElementById('aforismo-flash').classList.add('visible');

            // Rotate every 5 seconds
            aforismoInterval = setInterval(showNextAforismo, 5000);

            adjustNavPosition();
        }

        // ========== AFORISMOS FLASH ==========
        let aforismoIndex = 0;
        let aforismosShuffled = [];
        let aforismoInterval = null;

        function shuffleAforismos() {
            aforismosShuffled = [...aforismos];
            for (let i = aforismosShuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [aforismosShuffled[i], aforismosShuffled[j]] = [aforismosShuffled[j], aforismosShuffled[i]];
            }
            aforismoIndex = 0;
        }

        function showNextAforismo() {
            if (aforismoIndex >= aforismosShuffled.length) {
                shuffleAforismos();
            }
            const item = aforismosShuffled[aforismoIndex];
            aforismoIndex++;

            const flashEl = document.getElementById('aforismo-flash');
            const fraseEl = document.getElementById('aforismo-frase');
            const orgEl = document.getElementById('aforismo-org');

            // Fade out
            flashEl.classList.remove('visible');

            setTimeout(() => {
                fraseEl.textContent = '\u201c' + item.frase + '\u201d';
                orgEl.textContent = item.org;
                // Fade in
                flashEl.classList.add('visible');
            }, 800);
        }

        function adjustNavPosition() {
            const nav = document.getElementById('main-nav');
            const banner = document.getElementById('aforismos-banner');
            if (nav && banner) {
                const navHeight = nav.offsetHeight;
                banner.style.top = navHeight + 'px';
                document.body.style.paddingTop = (navHeight + banner.offsetHeight) + 'px';
            }
        }

        // ========== MANIFIESTO WORD-BY-WORD SCROLL ==========
        function initManifiestoTypewriter() {
            const section = document.getElementById('manifiesto');
            const tituloEl = document.getElementById('manifiesto-titulo');
            const cuerpoEl = document.getElementById('manifiesto-cuerpo');

            const tituloText = 'Lo que queremos...';
            const cuerpoText = 'Somos la cosecha del asfalto caliente, la generaci√≥n que aprendi√≥ a florecer justo donde nos dijeron que no crecer√≠a nada. Nacimos del estallido, no para quedarnos en el grito, sino para organizar la esperanza y convertir la indignaci√≥n en estructuras vivas. Desde la profundidad de la selva hasta la esquina del barrio, tejemos una red anfibia que conecta el remedio ancestral con el c√≥digo urbano, entendiendo que la cultura no es un adorno, sino nuestra herramienta m√°s afilada de defensa personal y colectiva. Aqu√≠ declaramos obsoleta la competencia: nuestra √∫nica pol√≠tica es la juntanza y nuestra venganza es la vida digna. No pedimos permiso para transformar el territorio; ya lo estamos haciendo, con la certeza de que nuestra rebeld√≠a no es amarga, sino creadora, ruidosa y radicalmente alegre.';

            // Crear spans para cada palabra
            function wordsToSpans(text) {
                return text.split(/\s+/).map(w => '<span class="mw">' + w + '</span>').join(' ');
            }

            tituloEl.innerHTML = wordsToSpans(tituloText);
            cuerpoEl.innerHTML = wordsToSpans(cuerpoText);

            const allWords = section.querySelectorAll('.mw');
            const totalWords = allWords.length;

            // Altura de secci√≥n: ~35px de scroll por palabra
            const scrollPerWord = 35;
            const sectionHeight = Math.max(totalWords * scrollPerWord + window.innerHeight, window.innerHeight * 3);
            section.style.minHeight = sectionHeight + 'px';

            let maxWordsRevealed = 0;
            let sectionHasLeft = false;

            function update() {
                const rect = section.getBoundingClientRect();
                const vh = window.innerHeight;

                // ¬øLa secci√≥n est√° completamente fuera del viewport?
                if (rect.bottom < 0 || rect.top > vh) {
                    // Secci√≥n sali√≥ del viewport -> resetear
                    if (maxWordsRevealed > 0) {
                        sectionHasLeft = true;
                        maxWordsRevealed = 0;
                        allWords.forEach(w => w.classList.remove('vis'));
                    }
                    return;
                }

                sectionHasLeft = false;

                // Trigger: secci√≥n entra en el tercio inferior de la pantalla
                // Es decir, rect.top < vh * 2/3 (el top de la secci√≥n ya pas√≥ el tercio inferior)
                const triggerPoint = vh * (2 / 3);
                if (rect.top > triggerPoint) {
                    return; // A√∫n no ha llegado al tercio inferior
                }

                // Cu√°nto scroll hemos hecho desde el trigger
                const scrollFromTrigger = Math.max(0, triggerPoint - rect.top);
                const scrollableRange = section.offsetHeight - vh * 0.33;
                const progress = Math.min(1, scrollFromTrigger / (scrollableRange * 0.85));

                const wordsToReveal = Math.floor(progress * totalWords);

                // Solo avanzar, nunca retroceder (hasta que la secci√≥n salga del viewport)
                if (wordsToReveal > maxWordsRevealed) {
                    maxWordsRevealed = wordsToReveal;
                }

                // Aplicar visibilidad
                allWords.forEach((w, i) => {
                    if (i < maxWordsRevealed) {
                        w.classList.add('vis');
                    } else {
                        w.classList.remove('vis');
                    }
                });
            }

            let ticking = false;
            window.addEventListener('scroll', function() {
                if (!ticking) {
                    requestAnimationFrame(function() {
                        update();
                        ticking = false;
                    });
                    ticking = true;
                }
            }, { passive: true });

            window.addEventListener('resize', function() {
                const newHeight = Math.max(totalWords * scrollPerWord + window.innerHeight, window.innerHeight * 3);
                section.style.minHeight = newHeight + 'px';
            });

            update();
        }

        // Cargar directorio
        function loadDirectorio() {
            const grid = document.getElementById('directorio-grid');
            
            grid.innerHTML = organizaciones.map(org => {
                const socialLinks = [];
                if (org.instagram) socialLinks.push(`<a href="${org.instagram}" target="_blank" class="hover:scale-110 transition">üì∑</a>`);
                if (org.facebook) socialLinks.push(`<a href="${org.facebook}" target="_blank" class="hover:scale-110 transition">üìò</a>`);
                if (org.tiktok) socialLinks.push(`<a href="${org.tiktok}" target="_blank" class="hover:scale-110 transition">üéµ</a>`);
                if (org.youtube) socialLinks.push(`<a href="${org.youtube}" target="_blank" class="hover:scale-110 transition">üì∫</a>`);
                if (org.twitter) socialLinks.push(`<a href="${org.twitter}" target="_blank" class="hover:scale-110 transition">üê¶</a>`);
                
                return `
                <div class="org-card">
                    ${org.logo ? `<img src="${org.logo}" alt="${org.nombre}" class="org-logo" onerror="this.style.display='none'">` : '<div class="org-logo bg-gray-200 rounded-full flex items-center justify-center text-2xl">üé®</div>'}
                    <h3 class="font-bold text-lg text-center mb-2">${org.nombre}</h3>
                    <p class="text-sm text-gray-600 text-center mb-3">${org.municipio}</p>
                    ${org.lema ? `<p class="text-xs italic text-center text-gray-500 mb-3">"${org.lema}"</p>` : ''}
                    <div class="text-xs text-gray-500 space-y-1">
                        <p><strong>Contacto:</strong> ${org.representante}</p>
                        <p class="truncate" title="${org.email}">${org.email}</p>
                        <p>${org.telefono}</p>
                        <p class="text-blue-600 font-semibold">${org.beneficiarios} beneficiarios</p>
                    </div>
                    ${socialLinks.length > 0 ? `<div class="flex justify-center gap-3 mt-4 text-xl">${socialLinks.join('')}</div>` : ''}
                </div>
            `}).join('');
        }

        // Menu m√≥vil
        document.addEventListener('DOMContentLoaded', function() {
            // Toggle men√∫ m√≥vil
            const menuToggle = document.getElementById('menu-toggle');
            const mobileMenu = document.createElement('div');
            mobileMenu.className = 'hidden md:hidden absolute top-full left-0 right-0 bg-white shadow-lg py-4';
            mobileMenu.innerHTML = `
                <ul class="flex flex-col space-y-2 px-4">
                    <li><a href="#inicio" class="block py-2 hover:text-orange-500">Inicio</a></li>
                    <li><a href="#galeria" class="block py-2 hover:text-orange-500">Galer√≠a</a></li>
                    <li><a href="#manifiesto" class="block py-2 hover:text-orange-500">Manifiesto</a></li>
                    <li><a href="#mapa" class="block py-2 hover:text-orange-500">Mapa</a></li>
                    <li><a href="#directorio" class="block py-2 hover:text-orange-500">Directorio</a></li>
                    <li><a href="#articulaciones" class="block py-2 hover:text-orange-500">Articulaciones</a></li>
                    <li><a href="#salvaguarda" class="block py-2 hover:text-orange-500">Salvaguarda</a></li>
                    <li><a href="#envolvente" class="block py-2 hover:text-orange-500">Envolvente</a></li>
                    <li><a href="#contacto" class="block py-2 hover:text-orange-500">Contacto</a></li>
                </ul>
            `;
            
            menuToggle.parentElement.appendChild(mobileMenu);
            
            menuToggle.addEventListener('click', function() {
                mobileMenu.classList.toggle('hidden');
            });
            
            // Cerrar men√∫ al hacer clic en un enlace
            mobileMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                });
            });
            
            // Inicializar todo
            createShuffle();
            
            // Mostrar primera foto inmediatamente
            setRandomBackground(false);
            
            // Precargar el resto y empezar rotaci√≥n
            preloadImages().then(() => {
                startPhotoRotation();
            });
            
            makeSlideShowClickable();
            loadAforismos();
            loadGallery();
            loadDirectorio();
            initMap();
            initManifiestoTypewriter();

            // Reajustar posiciones en resize
            window.addEventListener('resize', adjustNavPosition);
        });
    </script>
</body>
</html>
